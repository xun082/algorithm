<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      debugger;
      var isValidSerialization = function (
        preorder = "9,3,4,#,#,1,#,#,2,#,6,#,#"
      ) {
        /**
         * @author xun
         * @method æ ˆ
         * @timeComplexity O(N)
         * @spaceComplexity O(N)
         */
        const n = preorder.length;
        let index = 0;
        const stack = [1];

        while (index < n) {
          if (!stack.length) return false;

          if (preorder[index] === ",") {
            index++;
          } else if (preorder[index] === "#") {
            stack[stack.length - 1]--;
            if (stack[stack.length - 1] === 0) stack.pop();
            index++;
          } else {
            while (index < n && preorder[index] !== ",") {
              index++;
            }
            stack[stack.length - 1]--;
            if (stack[stack.length - 1] === 0) {
              stack.pop();
            }
            stack.push(2);
          }
        }

        return stack.length === 0;
      };

      isValidSerialization();
    </script>
  </body>
</html>
